# ๐ง ุฏููู ุชุดุบูู Migration Scripts

## ๐ ุงููุดููุฉ:
ุงูุณูุฑุจุชุงุช ุงูููุฌูุฏุฉ ูู ูููุงุช `.sql.txt` **ูุง ุชุนูู ุชููุงุฆูุงู** - ูุฌุจ ุชุดุบูููุง ูุฏููุงู ูู Supabase.

---

## โ ุงูุญู: ุฎุทูุงุช ุชุดุบูู ุงูุณูุฑุจุช

### **ุงูุทุฑููุฉ 1: ุนุจุฑ Supabase Dashboard (ุงูุฃุณูู)**

1. **ุงูุชุญ Supabase Dashboard:**
   - ุงุฐูุจ ุฅูู [supabase.com](https://supabase.com)
   - ุณุฌู ุฏุฎููู
   - ุงุฎุชุฑ ูุดุฑูุนู

2. **ุงูุชุญ SQL Editor:**
   - ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉุ ุงุถุบุท ุนูู **"SQL Editor"** (ุฃู "SQL Editor" ูู ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ)

3. **ุงูุณุฎ ุงูุณูุฑุจุช:**
   - ุงูุชุญ ููู `migration_160_add_actual_range_to_watchlist.sql.txt`
   - ุงูุณุฎ **ุงููุญุชูู ูุงูู** (Ctrl+A ุซู Ctrl+C)

4. **ุงูุตู ูุงุดุบู:**
   - ูู SQL Editorุ ุงุถุบุท **"New Query"**
   - ุงูุตู ุงูุณูุฑุจุช (Ctrl+V)
   - ุงุถุบุท **"Run"** ุฃู (Ctrl+Enter)

5. **ุชุญูู ูู ุงููุชูุฌุฉ:**
   - ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ: `SUCCESS: RPC function "get_the_coming_trend_data" updated...`

---

### **ุงูุทุฑููุฉ 2: ุนุจุฑ Supabase CLI (ูููุญุชุฑููู)**

ุฅุฐุง ูุงู ูุฏูู Supabase CLI ูุซุจุช:

```bash
# ุชุฃูุฏ ุฃูู ูู ูุฌูุฏ ุงููุดุฑูุน
cd ROWDB-main

# ุดุบู ุงูุณูุฑุจุช
supabase db reset --db-url "YOUR_DATABASE_URL" < migration_160_add_actual_range_to_watchlist.sql.txt
```

---

## ๐ ุงูุณูุฑุจุชุงุช ุงููุทููุจุฉ ุญุงููุงู:

### โ 1. `migration_159_add_table_column_translations.sql.txt`
**ุงูุบุฑุถ:** ุฅุถุงูุฉ ุชุฑุฌูุงุช ุฃุนูุฏุฉ ุงูุฌุฏูู (Symbol, Price & Date, etc.)

### โ 2. `migration_160_add_actual_range_to_watchlist.sql.txt`
**ุงูุบุฑุถ:** ุชุญุฏูุซ ุฏุงูุฉ `get_the_coming_trend_data()` ูุฌูุจ `actual_low` ู `actual_high`

---

## ๐ ููููุฉ ุงูุชุญูู ูู ูุฌุงุญ ุงูุณูุฑุจุช:

### ุงุฎุชุจุงุฑ ุงูุฏุงูุฉ:
```sql
-- ุดุบู ูุฐุง ุงูุณูุฑุจุช ูู SQL Editor
SELECT 
    symbol,
    actual_low,
    actual_high,
    indicator_date
FROM public.get_the_coming_trend_data()
LIMIT 5;
```

ุฅุฐุง ุธูุฑุช ุจูุงูุงุช ูู `actual_low` ู `actual_high` โ **ูุฌุญ ุงูุณูุฑุจุช!** โ

---

## โ ูุดุงูู ุดุงุฆุนุฉ:

### **ูุดููุฉ:** "function already exists"
**ุงูุญู:** ุงูุณูุฑุจุช ูุญุชูู ุนูู `DROP FUNCTION IF EXISTS` - ูุฌุจ ุฃู ูุนูู ุจุฏูู ูุดุงูู.

### **ูุดููุฉ:** "permission denied"
**ุงูุญู:** ุชุฃูุฏ ุฃูู ุชุณุชุฎุฏู ุญุณุงุจ **Admin** ุฃู **Owner** ูููุดุฑูุน.

### **ูุดููุฉ:** ุงูุจูุงูุงุช ูุง ุชุธูุฑ ุจุนุฏ ุชุดุบูู ุงูุณูุฑุจุช
**ุงูุญู:**
1. ุงูุณุญ ุงููุงุด ูู ุงููุชุตูุญ (Local Storage)
2. ุงุญุฐู: `dailyWatchlistData-v3` ู `dailyWatchlistTimestamp-v3`
3. ุญุฏุซ ุงูุตูุญุฉ (F5)

---

## ๐ ููุงุญุธุฉ ูููุฉ:

ุงูุณูุฑุจุชุงุช **ุขููุฉ ููุชุดุบูู ุนุฏุฉ ูุฑุงุช** - ุชุญุชูู ุนูู:
- `DROP FUNCTION IF EXISTS` (ูุง ูุฎุทุฆ ุฅุฐุง ุงูุฏุงูุฉ ููุฌูุฏุฉ)
- `IF NOT EXISTS` (ูุง ูุฎุทุฆ ุฅุฐุง ุงูุฌุฏูู/ุงูุนููุฏ ููุฌูุฏ)
- `BEGIN; ... COMMIT;` (ุชุฑุฌุน ุงูุชุบููุฑุงุช ุฅุฐุง ุญุฏุซ ุฎุทุฃ)

---

## ๐ ุฅุฐุง ุงุญุชุฌุช ูุณุงุนุฏุฉ:

ุฃุฑุณู ูู:
1. ุฑุณุงูุฉ ุงูุฎุทุฃ (ุฅู ูุฌุฏุช)
2. ูุชูุฌุฉ ุงุฎุชุจุงุฑ ุงูุฏุงูุฉ (ูู ูุณู "ุงุฎุชุจุงุฑ ุงูุฏุงูุฉ" ุฃุนูุงู)
3. ููุทุฉ ุดุงุดุฉ ูู SQL Editor ุฅู ุฃููู

