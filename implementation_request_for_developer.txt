المطلوب من المطوّر:

1. الهدف العام
- بناء منصة شبيهة تمامًا بالموقع الحالي Trendview مع التركيز على ملخصات السوق الأمريكي، قوائم المراقبة، دقة التوقعات، وملف ناسداك.
- الالتزام بالموارد المتاحة للمستخدم: حساب Supabase قائم، مستودع GitHub، استضافة Render للتطبيق الأمامي، ومصادر بيانات مجانية مثل Yahoo Finance و Stooq وملفات CSV الداخلية.

2. الهيكل العام للتطبيق
- واجهة مستخدم تعتمد على React مع Tailwind CSS أو إطار مشابه خفيف الوزن يدعم تصميم عربي/إنجليزي.
- إدارة الحالة عبر React Context (لغة، إعدادات، مصادقة، مفضلات) أو بديل بسيط مثل Zustand إذا فضّل المطوّر.
- طبقة بيانات عبر Supabase: استخدام auth، قاعدة بيانات PostgreSQL، ودوال RPC الحالية أو إعادة إنشائها بالاسم نفسه.
- دعم PWA (manifest، service worker) للتشغيل كتطبيق مستقل على الهواتف.

3. الصفحات المطلوبة
- صفحة هبوط تسويقية تعرض محتوى مترجم من جدول translations.
- لوحة تحكم إدارية لعرض مؤشرات النظام وتشغيل المهام المجدولة.
- صفحة “قائمة المراقبة اليومية” لجلب توقعات اليوم التالي من دالة get_daily_checklist مع البحث والمفضلة.
- صفحة “تحليل الأسهم” تعيد استخدام البيانات نفسها لكنها تظهر التاريخ الأحدث وأدوات فرز إضافية.
- صفحة “ماذا حدث” تعرض جدول جلسة التداول الأخيرة وتفاصيل السهم المختار باستخدام get_what_happened_summary و get_what_happened_stock_details.
- صفحة “ملخص ناسداك” تعتمد على جدول nasdaq_daily_snapshot مع الجداول الفرعية للتوقعات اليومية.
- صفحة “دقة التوقعات” تعرض جميع المخططات التحليلية مع استدعاءات RPC المتعددة المذكورة في الوثائق.
- صفحة “تحليل تاريخ التوقعات” لاستعراض الأداء حسب الفترة.
- صفحات إدارية لإدارة المستخدمين، الأدوار، الترجمات، الإعلانات، الملاحظات، السجلات، الإعدادات.

4. مصادر البيانات وتنفيذها
- استخدام Supabase كمنصة البيانات الرئيسية. يجب إنشاء الجداول التالية (أو التأكد من وجودها): stocks, historical_data, forecasts, forecast_checks, audit_forecast_metrics, technical_indicators, pattern_signals, user_favorites, user_notes, activity_logs, nasdaq_daily_snapshot, translations, app_settings، وغيرها كما موثق في database_contents_ar.txt.
- إنشاء الدوال المخزنة RPC التالية (أسماء مطابقة): get_daily_checklist، get_stock_details_page_data، get_what_happened_summary، get_what_happened_stock_details، get_latest_nasdaq_snapshot، get_forecast_accuracy_* (حسب التصنيفات)، evaluate_and_save_forecasts، trigger_daily_tasks، get_all_users_with_roles، get_active_announcements، وغيرها المذكورة في الوثائق.
- إعداد سكربت Python (يمكن إعادة استخدام update_nasdaq_daily_snapshot_minimal_ny.py) لتعبئة جدول nasdaq_daily_snapshot عبر yfinance و Stooq. تشغيله عبر GitHub Actions أو عملية خارجية.
- معالج دقة التوقعات: Trigger أو وظيفة مجدولة لتحديث forecast_checks بناءً على البيانات التاريخية.

5. المصادقة والصلاحيات
- تفعيل Row Level Security في Supabase. استخدام أدوار بسيطة: admin، manager، user.
- إنشاء سياسات تسمح للقراءة العامة للبيانات المفتوحة (stocks، historical_data، nasdaq_daily_snapshot) وتقييد التعديل للمسؤولين.
- استخدام Supabase Auth مع بريد إلكتروني وكلمة مرور، وتوفير شاشة تسجيل دخول مع التبديل للغة.

6. المتطلبات التصميمية
- دعم RTL و LTR مع التبديل الفوري عبر سياق اللغة.
- ألوان وهوية Trendview الحالية (الأزرق كلون أساسي، خلفيات فاتحة، بطاقات مستديرة، تدرجات لطيفة).
- جعل البطاقات الأساسية (نسبة النجاح، إجمالي التوقعات، ملخص ناسداك) واضحة بأرقام كبيرة.
- المخططات باستخدام مكتبة مثل Recharts أو D3 المخففة، مع الاهتمام بالأداء على الأجهزة الضعيفة.

7. البنية التحتية والنشر
- مستودع GitHub تزامن مع Render لنشر الواجهة. إضافة ملف build script (npm run build أو yarn build).
- إعداد manifest و service worker لتفعيل PWA. استخدام display "standalone" على الجوال و "browser" على سطح المكتب كما هو موجود في التطبيق الحالي.
- إمكانية استخدام GitHub Actions لتشغيل الاختبارات أو سكربتات التعبئة.

8. اختبار وضمان الجودة
- توفير بيانات افتراضية في Supabase (عبر SQL scripts) لتجربة الواجهة بدون الاعتماد على مصادر خارجية.
- كتابة ملاحظات حول كيفية تشغيل التحديثات اليومية (cron أو manual).
- اختبار ثنائي اللغة ورصد أي مفاتيح ترجمة ناقصة.
- اختبار PWA على iOS و Android والتأكد من تحميل الأيقونات ومستوى التكامل.

9. تسليم وثائق
- تحديث ملف README أو إنشاء دليل استخدام بالعربية يوضح إعداد البيئة محليًا (npm install، supabase url/key، ملفات env).
- توثيق الجداول والدوال كما في database_contents_ar.txt، وشرح الواجهة كما في site_services_ar.txt.
- إضافة مخطط بسيط لهيكلية التطبيق (مجلد components، contexts، hooks، services، pages).

10. الموارد المتاحة
- حساب Supabase مع مفاتيح الخدمة.
- مستودع GitHub الحالي.
- سكربت Python لجلب بيانات ناسداك.
- ملفات الترجمة والمخططات في مجلد translations أو json.
- إمكانية استخدام بيانات السوق المجانية (Yahoo Finance، Stooq) فقط دون اشتراكات مدفوعة.

المخرجات المتوقعة:
- تطبيق React جاهز للنشر على Render بنفس الوظائف الحالية.
- قاعدة بيانات Supabase متكاملة مع الجداول والدوال وسياسات RLS.
- سكربتات مساندة لجلب البيانات اليومية.
- وثائق تشغيل بالعربية توضح خطوات التهيئة والتشغيل والصيانة.
